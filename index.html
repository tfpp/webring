<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <script id="ring" type="application/json">
      [
        {"title": "Yahoo", "host": "yahoo.com", "homepage": "https://yahoo.com/"},
        {"title": "Localhost", "host": "localhost:8000", "homepage": "http://localhost:8000/"},
        {"title": "Google", "host": "google.com", "homepage": "https://google.com/"}
      ]
    </script>
    <style>
      #webring {
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: 1fr 1fr;
      }

      #webring div:first-child {
        text-align: left;
      }

      #webring div:last-child {
        text-align: right;
      }
    </style>
  </head>
  <body>
    <template id="webring-link">
      <div>
        <span><a id="webring-link-a" target="_top" href="#">Go</a></span>
      </div>
    </template>
    <div id="webring" role="navigation"></div>
  </body>
  <script>
    function mod(x, y) {
      return ((x % y) + y) % y;
    }

    function getCircular(list, index, offset) {
      const i = mod(index + offset, list.length);

      return list[i];
    }

    function renderLink(link) {
      const template = document.getElementById("webring-link");
      const clone = template.content.cloneNode(true);
      
      const a = clone.querySelector("a");
      a.innerText = link.title;
      a.href = link.homepage;

      return clone;
    }

    function getSelfIndex(list, host) {
      return list.findIndex((value) => value.host === host);
    }

    const referrer = new URL(document.referrer);
    const host = referrer.host;
    const ring = JSON.parse(document.getElementById("ring").innerText);
    const container = document.querySelector("#webring");
    const i = getSelfIndex(ring, referrer.host);

    container.appendChild(renderLink(getCircular(ring, i, -1)));
    container.appendChild(renderLink(getCircular(ring, i,  1)));
  </script>
</html>
